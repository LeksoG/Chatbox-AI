<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova AI Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        :root {
            --bg-primary: #111827;
            --bg-secondary: #1f2937;
            --bg-tertiary: #374151;
            --text-primary: #f3f4f6;
            --text-secondary: #9ca3af;
            --accent-primary: linear-gradient(to right, #2563eb, #7c3aed);
            --accent-secondary: linear-gradient(to right, #60a5fa, #a78bfa);
            --border-color: #374151;
            --message-user: linear-gradient(to right, #3b82f6, #2563eb);
            --message-bot: #1f2937;
            --suggestion-bg: #374151;
            --suggestion-text: #93c5fd;
            --button-bg: #374151;
            --button-text: #9ca3af;
            --input-bg: #374151;
            --header-bg: linear-gradient(to right, #2563eb, #7c3aed);
            --container-bg: linear-gradient(to bottom right, #111827, #1f2937);
            --online-indicator: #34d399;
        }

        .light-mode {
            --bg-primary: #f8fafc;
            --bg-secondary: #e2e8f0;
            --bg-tertiary: #cbd5e1;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent-primary: linear-gradient(to right, #3b82f6, #8b5cf6);
            --accent-secondary: linear-gradient(to right, #60a5fa, #a78bfa);
            --border-color: #cbd5e1;
            --message-user: linear-gradient(to right, #3b82f6, #2563eb);
            --message-bot: #e2e8f0;
            --suggestion-bg: #cbd5e1;
            --suggestion-text: #2563eb;
            --button-bg: #cbd5e1;
            --button-text: #475569;
            --input-bg: #f1f5f9;
            --header-bg: linear-gradient(to right, #3b82f6, #8b5cf6);
            --container-bg: linear-gradient(to bottom right, #f8fafc, #e2e8f0);
            --online-indicator: #10b981;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f2f5;
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            height: 700px;
            width: 100%;
            max-width: 500px;
            border: 1px solid rgba(107, 114, 128, 0.3);
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            background: var(--container-bg);
            overflow: hidden;
            position: relative;
        }

        .chat-header {
            padding: 0.75rem 1rem;
            background: var(--header-bg);
            color: white;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            display: flex;
            align-items: center;
        }

        .status-indicator {
            height: 0.75rem;
            width: 0.75rem;
            background-color: var(--online-indicator);
            border-radius: 50%;
            margin-right: 0.5rem;
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        .title {
            font-weight: 600;
        }

        .settings-button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .settings-button:hover {
            color: #bfdbfe;
        }

        .messages-container {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .message {
            margin-bottom: 1rem;
            display: flex;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.bot {
            justify-content: flex-start;
        }

        .avatar {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 0.25rem;
        }

        .user .avatar {
            background-color: #3b82f6;
            margin-left: 0.5rem;
        }

        .bot .avatar {
            background: var(--accent-secondary);
            margin-right: 0.5rem;
        }

        .message-bubble {
            max-width: 75%;
            padding: 0.75rem;
            border-radius: 0.5rem;
            animation: fadeInUp 0.3s ease-out forwards;
        }

        .user .message-bubble {
            background: var(--message-user);
            color: white;
            border-bottom-right-radius: 0;
        }

        .bot .message-bubble {
            background-color: var(--message-bot);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-bottom-left-radius: 0;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .typing-bubble {
            background-color: var(--message-bot);
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
        }

        .typing-dot {
            width: 0.5rem;
            height: 0.5rem;
            border-radius: 50%;
            margin-right: 0.25rem;
            animation: bounce 1.4s infinite;
        }

        .typing-dot:nth-child(1) {
            background-color: #60a5fa;
            animation-delay: 0ms;
        }

        .typing-dot:nth-child(2) {
            background-color: #a78bfa;
            animation-delay: 200ms;
        }

        .typing-dot:nth-child(3) {
            background-color: #60a5fa;
            animation-delay: 400ms;
            margin-right: 0;
        }

        .suggestions-container {
            padding: 0.5rem 0.75rem;
            background-color: var(--bg-secondary);
            overflow-x: auto;
            white-space: nowrap;
            animation: fadeIn 0.2s ease-out forwards;
            border-top: 1px solid var(--border-color);
        }

        .suggestions-list {
            display: flex;
            gap: 0.5rem;
        }

        .suggestion-btn {
            padding: 0.25rem 0.75rem;
            background-color: var(--suggestion-bg);
            color: var(--suggestion-text);
            border: none;
            border-radius: 9999px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: background-color 0.2s;
            white-space: nowrap;
        }

        .suggestion-btn:hover {
            background-color: var(--bg-tertiary);
        }

        .predefined-questions {
            max-height: 16rem;
            overflow-y: auto;
            border-top: 1px solid var(--border-color);
            background-color: var(--bg-secondary);
            animation: fadeIn 0.2s ease-out forwards;
        }

        .predefined-heading {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            padding: 0.5rem 0.75rem 0;
        }

        .questions-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.25rem;
            padding: 0 0.5rem 0.5rem;
        }

        .question-btn {
            text-align: left;
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            color: var(--suggestion-text);
            background: none;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .question-btn:hover {
            background-color: var(--bg-tertiary);
        }

        .input-container {
            padding: 0.75rem;
            border-top: 1px solid var(--border-color);
            background-color: var(--bg-secondary);
            border-bottom-left-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
        }

        .input-wrapper {
            display: flex;
            align-items: center;
            position: relative;
        }

        .emoji-button {
            color: var(--button-text);
            background: none;
            border: none;
            cursor: pointer;
            transition: color 0.2s;
            font-size: 1.25rem;
            padding: 0.25rem;
        }

        .emoji-button:hover {
            color: var(--suggestion-text);
        }

        .message-input {
            flex: 1;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--text-primary);
            border-radius: 9999px;
            padding: 0.5rem 1rem;
            margin: 0 0.5rem;
            outline: none;
        }

        .message-input::placeholder {
            color: var(--text-secondary);
        }

        .message-input:focus {
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }

        .send-button {
            padding: 0.5rem;
            border-radius: 9999px;
            border: none;
            background-color: var(--button-bg);
            color: var(--button-text);
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
        }

        .send-button.active {
            background: var(--accent-primary);
            color: white;
        }

        .send-button:disabled {
            cursor: default;
        }

        /* Emoji panel styles - enhanced */
        .emoji-panel {
            position: absolute;
            bottom: 70px;
            left: 10px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            width: 320px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            z-index: 10;
            animation: fadeIn 0.2s ease-out forwards;
            display: flex;
            flex-direction: column;
        }

        .emoji-categories {
            display: flex;
            overflow-x: auto;
            padding: 0.5rem;
            border-bottom: 1px solid var(--border-color);
            scrollbar-width: thin;
        }

        .category-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 0.25rem 0.5rem;
            margin-right: 0.5rem;
            cursor: pointer;
            border-radius: 0.25rem;
            white-space: nowrap;
            transition: background-color 0.2s, color 0.2s;
        }

        .category-btn.active {
            background-color: var(--bg-tertiary);
            color: var(--suggestion-text);
        }

        .category-btn:hover:not(.active) {
            background-color: var(--bg-tertiary);
            color: var(--suggestion-text);
        }

        .emoji-grid-container {
            max-height: 200px;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .emoji-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 0.5rem;
        }

        .emoji-btn {
            font-size: 1.25rem;
            background: none;
            border: none;
            cursor: pointer;
            border-radius: 0.25rem;
            transition: background-color 0.2s, transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
            width: 100%;
            height: 100%;
        }

        .emoji-btn:hover {
            background-color: var(--bg-tertiary);
            transform: scale(1.1);
        }

        .category-content {
            display: none;
            animation: fadeIn 0.3s ease-out forwards;
        }

        .category-content.active {
            display: block;
        }

        .emoji-search {
            padding: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .emoji-search input {
            width: 100%;
            padding: 0.5rem;
            border-radius: 0.25rem;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--text-primary);
            outline: none;
        }

        .emoji-search input::placeholder {
            color: var(--text-secondary);
        }

        /* Settings panel styles */
        .settings-panel {
            position: absolute;
            top: 0;
            right: -350px; /* Start off-screen */
            width: 350px;
            height: 100%;
            background-color: var(--bg-secondary);
            z-index: 20;
            transition: right 0.3s ease-in-out;
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .settings-panel.active {
            right: 0;
        }

        .settings-header {
            padding: 1rem;
            background: var(--header-bg);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .settings-title {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .close-settings {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .settings-content {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
        }

        .settings-section {
            margin-bottom: 1.5rem;
        }

        .settings-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            padding-bottom: 0.3rem;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .settings-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.7rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .option-label {
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .option-description {
            color: var(--text-secondary);
            font-size: 0.75rem;
            margin-top: 0.2rem;
        }

        /* Toggle switch */
        .toggle {
            position: relative;
            display: inline-block;
            width: 46px;
            height: 24px;
        }

        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-tertiary);
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #3b82f6;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }

        /* Select styling */
        .select-wrapper {
            position: relative;
        }

        .settings-select {
            appearance: none;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            padding: 0.5rem 2rem 0.5rem 0.75rem;
            border-radius: 0.25rem;
            color: var(--text-primary);
            cursor: pointer;
            min-width: 120px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280' stroke-width='2'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1em 1em;
        }

        /* Button styling */
        .settings-button-group {
            display: flex;
            justify-content: flex-end;
            margin-top: 1rem;
        }

        .settings-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .settings-btn-primary {
            background: var(--accent-primary);
            color: white;
            border: none;
        }

        .settings-btn-secondary {
            background: none;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            margin-right: 0.5rem;
        }

        /* Overlay for settings panel */
        .settings-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 15;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .settings-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        .hidden {
            display: none;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-tertiary);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="chat-container" id="chatContainer">
        <!-- Chat Header -->
        <div class="chat-header">
            <div class="header-title">
                <div class="status-indicator"></div>
                <h2 class="title">Nova AI Assistant</h2>
            </div>
            <button class="settings-button" id="settingsButton" title="Settings">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
            </button>
        </div>
        
        <!-- Messages Area -->
        <div class="messages-container" id="messagesContainer">
            <!-- Bot welcome message will be added here by JS -->

            <!-- Typing indicator (hidden by default) -->
            <div class="typing-indicator hidden" id="typingIndicator">
                <div class="avatar">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <div class="typing-bubble">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        </div>
        
        <!-- Suggestions Area -->
        <div class="suggestions-container" id="suggestionsContainer">
            <div class="suggestions-list" id="suggestionsList">
                <!-- Suggestions will be added dynamically -->
            </div>
        </div>
        
        <!-- Predefined Questions (hidden by default) -->
        <div class="predefined-questions hidden" id="predefinedQuestions">
            <p class="predefined-heading">What would you like to chat about?</p>
            <div class="questions-grid" id="questionsGrid">
                <!-- Questions will be added dynamically -->
            </div>
        </div>
        
        <!-- Enhanced Emoji Panel (hidden by default) -->
        <div class="emoji-panel hidden" id="emojiPanel">
            <!-- Emoji search -->
            <div class="emoji-search">
                <input type="text" id="emojiSearch" placeholder="Search emojis...">
            </div>
            
            <!-- Emoji categories -->
            <div class="emoji-categories" id="emojiCategories">
                <!-- Categories will be added dynamically -->
            </div>
            
            <!-- Emoji grid container -->
            <div class="emoji-grid-container">
                <!-- Category content will be added dynamically -->
            </div>
        </div>
        
        <!-- Settings Panel (hidden by default) -->
        <div class="settings-panel" id="settingsPanel">
            <div class="settings-header">
                <div class="settings-title">Settings</div>
                <button class="close-settings" id="closeSettings">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="settings-content">
                <!-- Appearance Section -->
                <div class="settings-section">
                    <div class="settings-section-title">Appearance</div>
                    <div class="settings-option">
                        <div>
                            <div class="option-label">Dark Mode</div>
                            <div class="option-description">Switch between light and dark theme</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="darkModeToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-option">
                        <div>
                            <div class="option-label">Font Size</div>
                            <div class="option-description">Adjust the text size</div>
                        </div>
                        <div class="select-wrapper">
                            <select class="settings-select" id="fontSizeSelect">
                                <option value="small">Small</option>
                                <option value="medium" selected>Medium</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Notifications Section -->
                <div class="settings-section">
                    <div class="settings-section-title">Notifications</div>
                    <div class="settings-option">
                        <div>
                            <div class="option-label">Sound Effects</div>
                            <div class="option-description">Play sounds for new messages</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="soundToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-option">
                        <div>
                            <div class="option-label">Desktop Notifications</div>
                            <div class="option-description">Show notifications for new messages</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="notificationsToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Chat Settings Section -->
                <div class="settings-section">
                    <div class="settings-section-title">Chat Settings</div>
                    <div class="settings-option">
                        <div>
                            <div class="option-label">Show Typing Indicator</div>
                            <div class="option-description">Display when Nova is typing</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="typingToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-option">
                        <div>
                            <div class="option-label">Auto-Suggestions</div>
                            <div class="option-description">Show response suggestions</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="suggestionsToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-option">
                        <div>
                            <div class="option-label">Response Speed</div>
                            <div class="option-description">Adjust how quickly Nova responds</div>
                        </div>
                        <div class="select-wrapper">
                            <select class="settings-select" id="speedSelect">
                                <option value="fast">Fast</option>
                                <option value="normal" selected>Normal</option>
                                <option value="slow">Realistic</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- About Section -->
                <div class="settings-section">
                    <div class="settings-section-title">About</div>
                    <div class="settings-option" style="border-bottom: none;">
                        <div>
                            <div class="option-label">Nova AI Assistant</div>
                            <div class="option-description">Version 1.0.0</div>
                            <div class="option-description" style="margin-top: 0.5rem;">An AI-powered conversational assistant designed to help with questions, tasks, and friendly chat.</div>
                        </div>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="settings-button-group">
                    <button class="settings-btn settings-btn-secondary" id="resetSettings">Reset to Default</button>
                    <button class="settings-btn settings-btn-primary" id="saveSettings">Save Changes</button>
                </div>
            </div>
        </div>

        <!-- Settings Overlay -->
        <div class="settings-overlay" id="settingsOverlay"></div>
        
        <!-- Input Area -->
        <div class="input-container">
            <div class="input-wrapper">
                <button class="emoji-button" id="emojiButton" title="Insert emoji">
                    ðŸ˜Š
                </button>
                <input 
                    type="text" 
                    class="message-input" 
                    id="messageInput" 
                    placeholder="Type your message..." 
                />
                <button class="send-button" id="sendButton" disabled>
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const chatContainer = document.getElementById('chatContainer');
            const messagesContainer = document.getElementById('messagesContainer');
            const typingIndicator = document.getElementById('typingIndicator');
            const suggestionsContainer = document.getElementById('suggestionsContainer');
            const suggestionsList = document.getElementById('suggestionsList');
            const predefinedQuestions = document.getElementById('predefinedQuestions');
            const questionsGrid = document.getElementById('questionsGrid');
            const emojiButton = document.getElementById('emojiButton');
            const emojiPanel = document.getElementById('emojiPanel');
            const emojiCategories = document.getElementById('emojiCategories');
            const emojiGridContainer = document.querySelector('.emoji-grid-container');
            const emojiSearch = document.getElementById('emojiSearch');
            const messageInput = document.getElementById('messageInput');
            const sendButton = document.getElementById('sendButton');
            
            // Settings elements
            const settingsButton = document.getElementById('settingsButton');
            const settingsPanel = document.getElementById('settingsPanel');
            const closeSettings = document.getElementById('closeSettings');
            const settingsOverlay = document.getElementById('settingsOverlay');
            const darkModeToggle = document.getElementById('darkModeToggle');
            const fontSizeSelect = document.getElementById('fontSizeSelect');
            const soundToggle = document.getElementById('soundToggle');
            const notificationsToggle = document.getElementById('notificationsToggle');
            const typingToggle = document.getElementById('typingToggle');
            const suggestionsToggle = document.getElementById('suggestionsToggle');
            const speedSelect = document.getElementById('speedSelect');
            const resetSettings = document.getElementById('resetSettings');
            const saveSettings = document.getElementById('saveSettings');
            
            // Sound effects
            const messageSound = new Audio('data:audio/wav;base64,UklGRiQFAABXQVZFZm10IBAAAAABAAIARKwAABCxAgAEABAAZGF0YQAFAACBhYqFbF1fdJOirKKJc19Tc4iVoJ+SgWxZWHSNm6OkmolgWGB3kJujopiFaFpeeJGco6GYgmZZXXqRm6OfloFmWV15kJqjopiFZ1ldeJCao6OYhGdZXXiPmqOjmIVnWV14j5qiopeFZ1ldeJCaoqKYhGdZXXiPmqKimIRnWV14kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWl54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEaFpeeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGdZXniQmqKhmIRnWV54kJqioZiEZ1leeJCaoqGYhGhZXnmQmqGgmINnWV55kZqhoJiEaFleeZGaoaCYhGhZX3mRmaCgmINnWV95kZmgoJiDZ1lfeZGZoJ+Xg2dZX3mRmZ+fl4NnWV95kZmfn5eDZ1lfeZGZn5+Xg2dZX3mRmZ+fl4NnWV95kZmfn5eDaFpgg==');

            // State variables
            let messages = [];
            let isTyping = false;
            let showQuestions = false;
            let showEmojis = false;
            let showSuggestions = true;
            let currentEmojiCategory = 'smileys';
            let searchTimeout = null;
            let darkMode = true;
            let fontSize = 'medium';
            let soundEnabled = false;
            let notificationsEnabled = false;
            let typingEnabled = true;
            let suggestionsEnabled = true;
            let responseSpeed = 'normal';
            
            // Emoji categories with their emojis
            const emojiData = {
                smileys: {
                    name: "ðŸ˜Š Smileys",
                    emojis: [
                        'ðŸ˜€', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ˜', 'ðŸ˜†', 'ðŸ˜…', 'ðŸ˜‚', 'ðŸ¤£', 'ðŸ¥²', 'â˜ºï¸',
                        'ðŸ˜Š', 'ðŸ˜‡', 'ðŸ™‚', 'ðŸ™ƒ', 'ðŸ˜‰', 'ðŸ˜Œ', 'ðŸ˜', 'ðŸ¥°', 'ðŸ˜˜', 'ðŸ˜—',
                        'ðŸ˜™', 'ðŸ˜š', 'ðŸ˜‹', 'ðŸ˜›', 'ðŸ˜', 'ðŸ˜œ', 'ðŸ¤ª', 'ðŸ¤¨', 'ðŸ§', 'ðŸ¤“',
                        'ðŸ˜Ž', 'ðŸ¥¸', 'ðŸ¤©', 'ðŸ¥³', 'ðŸ˜', 'ðŸ˜’', 'ðŸ˜ž', 'ðŸ˜”', 'ðŸ˜Ÿ', 'ðŸ˜•',
                        'ðŸ™', 'â˜¹ï¸', 'ðŸ˜£', 'ðŸ˜–', 'ðŸ˜«', 'ðŸ˜©', 'ðŸ¥º', 'ðŸ˜¢', 'ðŸ˜­', 'ðŸ˜®â€ðŸ’¨',
                        'ðŸ˜¤', 'ðŸ˜ ', 'ðŸ˜¡', 'ðŸ¤¬', 'ðŸ¤¯', 'ðŸ˜³', 'ðŸ¥µ', 'ðŸ¥¶', 'ðŸ˜±', 'ðŸ˜¨',
                        'ðŸ˜°', 'ðŸ˜¥', 'ðŸ˜“', 'ðŸ¤—', 'ðŸ¤”', 'ðŸ¤­', 'ðŸ¤«', 'ðŸ¤¥', 'ðŸ˜¶', 'ðŸ˜¶â€ðŸŒ«ï¸',
                        'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜¬', 'ðŸ™„', 'ðŸ˜¯', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜®', 'ðŸ˜²', 'ðŸ¥±',
                        'ðŸ˜´', 'ðŸ¤¤', 'ðŸ˜ª', 'ðŸ˜µ', 'ðŸ˜µâ€ðŸ’«', 'ðŸ¤', 'ðŸ¥´', 'ðŸ¤¢', 'ðŸ¤®', 'ðŸ¤§'
                    ]
                },
                people: {
                    name: "ðŸ‘¨ People",
                    emojis: [
                        'ðŸ‘‹', 'ðŸ¤š', 'âœ‹', 'ðŸ––', 'ðŸ‘Œ', 'ðŸ¤Œ', 'ðŸ¤', 'âœŒï¸', 'ðŸ¤ž', 'ðŸ¤Ÿ',
                        'ðŸ¤˜', 'ðŸ¤™', 'ðŸ‘ˆ', 'ðŸ‘‰', 'ðŸ‘†', 'ðŸ–•', 'ðŸ‘‡', 'â˜ï¸', 'ðŸ‘', 'ðŸ‘Ž',
                        'âœŠ', 'ðŸ‘Š', 'ðŸ¤›', 'ðŸ¤œ', 'ðŸ‘', 'ðŸ™Œ', 'ðŸ‘', 'ðŸ¤²', 'ðŸ™', 'âœï¸',
                        'ðŸ’…', 'ðŸ¤³', 'ðŸ’ª', 'ðŸ¦¾', 'ðŸ¦µ', 'ðŸ¦¿', 'ðŸ¦¶', 'ðŸ‘£', 'ðŸ‘‚', 'ðŸ¦»',
                        'ðŸ‘ƒ', 'ðŸ«€', 'ðŸ«', 'ðŸ§ ', 'ðŸ¦·', 'ðŸ¦´', 'ðŸ‘€', 'ðŸ‘ï¸', 'ðŸ‘…', 'ðŸ‘„',
                        'ðŸ’‹', 'ðŸ©¸', 'ðŸ‘¶', 'ðŸ‘§', 'ðŸ§’', 'ðŸ‘¦', 'ðŸ‘©', 'ðŸ§‘', 'ðŸ‘¨', 'ðŸ‘±â€â™€ï¸',
                        'ðŸ‘±', 'ðŸ‘±â€â™‚ï¸', 'ðŸ‘´', 'ðŸ‘µ', 'ðŸ§“', 'ðŸ‘²', 'ðŸ‘³â€â™€ï¸', 'ðŸ‘³', 'ðŸ‘³â€â™‚ï¸', 'ðŸ§•',
                        'ðŸ‘®â€â™€ï¸', 'ðŸ‘®', 'ðŸ‘®â€â™‚ï¸', 'ðŸ‘·â€â™€ï¸', 'ðŸ‘·', 'ðŸ‘·â€â™‚ï¸', 'ðŸ’‚â€â™€ï¸', 'ðŸ’‚', 'ðŸ’‚â€â™‚ï¸', 'ðŸ•µï¸â€â™€ï¸',
                        'ðŸ•µï¸', 'ðŸ•µï¸â€â™‚ï¸', 'ðŸ‘©â€âš•ï¸', 'ðŸ§‘â€âš•ï¸', 'ðŸ‘¨â€âš•ï¸', 'ðŸ‘©â€ðŸŒ¾', 'ðŸ§‘â€ðŸŒ¾', 'ðŸ‘¨â€ðŸŒ¾', 'ðŸ‘©â€ðŸ³', 'ðŸ§‘â€ðŸ³'
                    ]
                },
                animals: {
                    name: "ðŸ± Animals",
                    emojis: [
                        'ðŸ¶', 'ðŸ±', 'ðŸ­', 'ðŸ¹', 'ðŸ°', 'ðŸ¦Š', 'ðŸ»', 'ðŸ¼', 'ðŸ»â€â„ï¸', 'ðŸ¨',
                        'ðŸ¯', 'ðŸ¦', 'ðŸ®', 'ðŸ·', 'ðŸ½', 'ðŸ¸', 'ðŸµ', 'ðŸ™ˆ', 'ðŸ™‰', 'ðŸ™Š',
                        'ðŸ’', 'ðŸ”', 'ðŸ§', 'ðŸ¦', 'ðŸ¤', 'ðŸ£', 'ðŸ¥', 'ðŸ¦†', 'ðŸ¦…', 'ðŸ¦‰',
                        'ðŸ¦‡', 'ðŸº', 'ðŸ—', 'ðŸ´', 'ðŸ¦„', 'ðŸ', 'ðŸª±', 'ðŸ›', 'ðŸ¦‹', 'ðŸŒ',
                        'ðŸž', 'ðŸœ', 'ðŸª°', 'ðŸª²', 'ðŸª³', 'ðŸ¦Ÿ', 'ðŸ¦—', 'ðŸ•·ï¸', 'ðŸ•¸ï¸', 'ðŸ¦‚',
                        'ðŸ¢', 'ðŸ', 'ðŸ¦Ž', 'ðŸ¦–', 'ðŸ¦•', 'ðŸ™', 'ðŸ¦‘', 'ðŸ¦', 'ðŸ¦ž', 'ðŸ¦€',
                        'ðŸ¡', 'ðŸ ', 'ðŸŸ', 'ðŸ¬', 'ðŸ³', 'ðŸ‹', 'ðŸ¦ˆ', 'ðŸŠ', 'ðŸ…', 'ðŸ†',
                        'ðŸ¦“', 'ðŸ¦', 'ðŸ¦§', 'ðŸ¦£', 'ðŸ˜', 'ðŸ¦›', 'ðŸ¦', 'ðŸª', 'ðŸ«', 'ðŸ¦’',
                        'ðŸ¦˜', 'ðŸ¦¬', 'ðŸƒ', 'ðŸ‚', 'ðŸ„', 'ðŸŽ', 'ðŸ–', 'ðŸ', 'ðŸ‘', 'ðŸ¦™'
                    ]
                },
                food: {
                    name: "ðŸ” Food",
                    emojis: [
                        'ðŸ', 'ðŸŽ', 'ðŸ', 'ðŸŠ', 'ðŸ‹', 'ðŸŒ', 'ðŸ‰', 'ðŸ‡', 'ðŸ“', 'ðŸ«',
                        'ðŸˆ', 'ðŸ’', 'ðŸ‘', 'ðŸ¥­', 'ðŸ', 'ðŸ¥¥', 'ðŸ¥', 'ðŸ…', 'ðŸ†', 'ðŸ¥‘',
                        'ðŸ¥¦', 'ðŸ¥¬', 'ðŸ¥’', 'ðŸŒ¶ï¸', 'ðŸ«‘', 'ðŸŒ½', 'ðŸ¥•', 'ðŸ«’', 'ðŸ§„', 'ðŸ§…',
                        'ðŸ¥”', 'ðŸ ', 'ðŸ¥', 'ðŸ¥¯', 'ðŸž', 'ðŸ¥–', 'ðŸ¥¨', 'ðŸ§€', 'ðŸ¥š', 'ðŸ³',
                        'ðŸ§ˆ', 'ðŸ¥ž', 'ðŸ§‡', 'ðŸ¥“', 'ðŸ¥©', 'ðŸ—', 'ðŸ–', 'ðŸ¦´', 'ðŸŒ­', 'ðŸ”',
                        'ðŸŸ', 'ðŸ•', 'ðŸ«“', 'ðŸ¥ª', 'ðŸ¥™', 'ðŸ§†', 'ðŸŒ®', 'ðŸŒ¯', 'ðŸ«”', 'ðŸ¥—',
                        'ðŸ¥˜', 'ðŸ«•', 'ðŸ¥«', 'ðŸ', 'ðŸœ', 'ðŸ²', 'ðŸ›', 'ðŸ£', 'ðŸ±', 'ðŸ¥Ÿ',
                        'ðŸ¦ª', 'ðŸ¤', 'ðŸ™', 'ðŸš', 'ðŸ˜', 'ðŸ¥', 'ðŸ¥ ', 'ðŸ¥®', 'ðŸ¢', 'ðŸ¡',
                        'ðŸ§', 'ðŸ¨', 'ðŸ¦', 'ðŸ¥§', 'ðŸ§', 'ðŸ°', 'ðŸŽ‚', 'ðŸ®', 'ðŸ­', 'ðŸ¬'
                    ]
                },
                travel: {
                    name: "ðŸš€ Travel",
                    emojis: [
                        'ðŸš—', 'ðŸš•', 'ðŸš™', 'ðŸšŒ', 'ðŸšŽ', 'ðŸŽï¸', 'ðŸš“', 'ðŸš‘', 'ðŸš’', 'ðŸš',
                        'ðŸ›»', 'ðŸšš', 'ðŸš›', 'ðŸšœ', 'ðŸ¦¯', 'ðŸ¦½', 'ðŸ¦¼', 'ðŸ›´', 'ðŸš²', 'ðŸ›µ',
                        'ðŸï¸', 'ðŸ›º', 'ðŸš¨', 'ðŸš”', 'ðŸš', 'ðŸš˜', 'ðŸš–', 'ðŸš¡', 'ðŸš ', 'ðŸšŸ',
                        'ðŸšƒ', 'ðŸš‹', 'ðŸšž', 'ðŸš', 'ðŸš„', 'ðŸš…', 'ðŸšˆ', 'ðŸš‚', 'ðŸš†', 'ðŸš‡',
                        'ðŸšŠ', 'ðŸš‰', 'âœˆï¸', 'ðŸ›«', 'ðŸ›¬', 'ðŸ›©ï¸', 'ðŸ’º', 'ðŸ›°ï¸', 'ðŸš€', 'ðŸ›¸',
                        'ðŸš', 'ðŸ›¶', 'â›µ', 'ðŸš¤', 'ðŸ›¥ï¸', 'ðŸ›³ï¸', 'â›´ï¸', 'ðŸš¢', 'âš“', 'ðŸª',
                        'â›½', 'ðŸš§', 'ðŸš¦', 'ðŸš¥', 'ðŸš', 'ðŸ—ºï¸', 'ðŸ—¿', 'ðŸ—½', 'ðŸ—¼', 'ðŸ°',
                        'ðŸ¯', 'ðŸŸï¸', 'ðŸŽ¡', 'ðŸŽ¢', 'ðŸŽ ', 'â›²', 'â›±ï¸', 'ðŸ–ï¸', 'ðŸï¸', 'ðŸœï¸',
                        'ðŸŒ‹', 'â›°ï¸', 'ðŸ”ï¸', 'ðŸ—»', 'ðŸ•ï¸', 'â›º', 'ðŸ›–', 'ðŸ ', 'ðŸ¡', 'ðŸ˜ï¸'
                    ]
                },
                objects: {
                    name: "ðŸ’¡ Objects",
                    emojis: [
                        'âŒš', 'ðŸ“±', 'ðŸ“²', 'ðŸ’»', 'âŒ¨ï¸', 'ðŸ–¥ï¸', 'ðŸ–¨ï¸', 'ðŸ–±ï¸', 'ðŸ–²ï¸', 'ðŸ•¹ï¸',
                        'ðŸ—œï¸', 'ðŸ’½', 'ðŸ’¾', 'ðŸ’¿', 'ðŸ“€', 'ðŸ“¼', 'ðŸ“·', 'ðŸ“¸', 'ðŸ“¹', 'ðŸŽ¥',
                        'ðŸ“½ï¸', 'ðŸŽžï¸', 'ðŸ“ž', 'â˜Žï¸', 'ðŸ“Ÿ', 'ðŸ“ ', 'ðŸ“º', 'ðŸ“»', 'ðŸŽ™ï¸', 'ðŸŽšï¸',
                        'ðŸŽ›ï¸', 'ðŸ§­', 'â±ï¸', 'â²ï¸', 'â°', 'ðŸ•°ï¸', 'âŒ›', 'â³', 'ðŸ“¡', 'ðŸ”‹',
                        'ðŸ”Œ', 'ðŸ’¡', 'ðŸ”¦', 'ðŸ•¯ï¸', 'ðŸª”', 'ðŸ§¯', 'ðŸ›¢ï¸', 'ðŸ’¸', 'ðŸ’µ', 'ðŸ’´',
                        'ðŸ’¶', 'ðŸ’·', 'ðŸª™', 'ðŸ’°', 'ðŸ’³', 'ðŸ’Ž', 'âš–ï¸', 'ðŸªœ', 'ðŸ§°', 'ðŸª›',
                        'ðŸ”§', 'ðŸ”¨', 'âš’ï¸', 'ðŸ› ï¸', 'ðŸªš', 'ðŸ”©', 'âš™ï¸', 'ðŸª¤', 'ðŸ§±', 'â›“ï¸',
                        'ðŸ§²', 'ðŸ”«', 'ðŸ’£', 'ðŸ§¨', 'ðŸª“', 'ðŸ”ª', 'ðŸ—¡ï¸', 'âš”ï¸', 'ðŸ›¡ï¸', 'ðŸš¬',
                        'âš°ï¸', 'âš±ï¸', 'ðŸº', 'ðŸ”®', 'ðŸ“¿', 'ðŸ§¿', 'ðŸ’ˆ', 'âš—ï¸', 'ðŸ”­', 'ðŸ”¬'
                    ]
                },
                symbols: {
                    name: "ðŸ”£ Symbols",
                    emojis: [
                        'â¤ï¸', 'ðŸ§¡', 'ðŸ’›', 'ðŸ’š', 'ðŸ’™', 'ðŸ’œ', 'ðŸ–¤', 'ðŸ¤', 'ðŸ¤Ž', 'ðŸ’”',
                        'â£ï¸', 'ðŸ’•', 'ðŸ’ž', 'ðŸ’“', 'ðŸ’—', 'ðŸ’–', 'ðŸ’˜', 'ðŸ’', 'ðŸ’Ÿ', 'â˜®ï¸',
                        'âœï¸', 'â˜ªï¸', 'ðŸ•‰ï¸', 'â˜¸ï¸', 'âœ¡ï¸', 'ðŸ”¯', 'ðŸ•Ž', 'â˜¯ï¸', 'â˜¦ï¸', 'ðŸ›',
                        'â›Ž', 'â™ˆ', 'â™‰', 'â™Š', 'â™‹', 'â™Œ', 'â™', 'â™Ž', 'â™', 'â™',
                        'â™‘', 'â™’', 'â™“', 'ðŸ†”', 'âš›ï¸', 'ðŸ‰‘', 'â˜¢ï¸', 'â˜£ï¸', 'ðŸ“´', 'ðŸ“³',
                        'ðŸˆ¶', 'ðŸˆš', 'ðŸˆ¸', 'ðŸˆº', 'ðŸˆ·ï¸', 'âœ´ï¸', 'ðŸ†š', 'ðŸ’®', 'ðŸ‰', 'ãŠ™ï¸',
                        'ãŠ—ï¸', 'ðŸˆ´', 'ðŸˆµ', 'ðŸˆ¹', 'ðŸˆ²', 'ðŸ…°ï¸', 'ðŸ…±ï¸', 'ðŸ†Ž', 'ðŸ†‘', 'ðŸ…¾ï¸',
                        'ðŸ†˜', 'âŒ', 'â­•', 'ðŸ›‘', 'â›”', 'ðŸ“›', 'ðŸš«', 'ðŸ’¯', 'ðŸ’¢', 'â™¨ï¸',
                        'ðŸš·', 'ðŸš¯', 'ðŸš³', 'ðŸš±', 'ðŸ”ž', 'ðŸ“µ', 'ðŸš­', 'â—', 'â•', 'â“'
                    ]
                },
                flags: {
                    name: "ðŸ Flags",
                    emojis: [
                        'ðŸ', 'ðŸš©', 'ðŸŽŒ', 'ðŸ´', 'ðŸ³ï¸', 'ðŸ³ï¸â€ðŸŒˆ', 'ðŸ³ï¸â€âš§ï¸', 'ðŸ´â€â˜ ï¸', 'ðŸ‡¦ðŸ‡¨', 'ðŸ‡¦ðŸ‡©',
                        'ðŸ‡¦ðŸ‡ª', 'ðŸ‡¦ðŸ‡«', 'ðŸ‡¦ðŸ‡¬', 'ðŸ‡¦ðŸ‡®', 'ðŸ‡¦ðŸ‡±', 'ðŸ‡¦ðŸ‡²', 'ðŸ‡¦ðŸ‡´', 'ðŸ‡¦ðŸ‡¶', 'ðŸ‡¦ðŸ‡·', 'ðŸ‡¦ðŸ‡¸',
                        'ðŸ‡¦ðŸ‡¹', 'ðŸ‡¦ðŸ‡º', 'ðŸ‡¦ðŸ‡¼', 'ðŸ‡¦ðŸ‡½', 'ðŸ‡¦ðŸ‡¿', 'ðŸ‡§ðŸ‡¦', 'ðŸ‡§ðŸ‡§', 'ðŸ‡§ðŸ‡©', 'ðŸ‡§ðŸ‡ª', 'ðŸ‡§ðŸ‡«',
                        'ðŸ‡§ðŸ‡¬', 'ðŸ‡§ðŸ‡­', 'ðŸ‡§ðŸ‡®', 'ðŸ‡§ðŸ‡¯', 'ðŸ‡§ðŸ‡±', 'ðŸ‡§ðŸ‡²', 'ðŸ‡§ðŸ‡³', 'ðŸ‡§ðŸ‡´', 'ðŸ‡§ðŸ‡¶', 'ðŸ‡§ðŸ‡·',
                        'ðŸ‡§ðŸ‡¸', 'ðŸ‡§ðŸ‡¹', 'ðŸ‡§ðŸ‡»', 'ðŸ‡§ðŸ‡¼', 'ðŸ‡§ðŸ‡¾', 'ðŸ‡§ðŸ‡¿', 'ðŸ‡¨ðŸ‡¦', 'ðŸ‡¨ðŸ‡¨', 'ðŸ‡¨ðŸ‡©', 'ðŸ‡¨ðŸ‡«',
                        'ðŸ‡¨ðŸ‡¬', 'ðŸ‡¨ðŸ‡­', 'ðŸ‡¨ðŸ‡®', 'ðŸ‡¨ðŸ‡°', 'ðŸ‡¨ðŸ‡±', 'ðŸ‡¨ðŸ‡²', 'ðŸ‡¨ðŸ‡³', 'ðŸ‡¨ðŸ‡´', 'ðŸ‡¨ðŸ‡µ', 'ðŸ‡¨ðŸ‡·',
                        'ðŸ‡¨ðŸ‡º', 'ðŸ‡¨ðŸ‡»', 'ðŸ‡¨ðŸ‡¼', 'ðŸ‡¨ðŸ‡½', 'ðŸ‡¨ðŸ‡¾', 'ðŸ‡¨ðŸ‡¿', 'ðŸ‡©ðŸ‡ª', 'ðŸ‡©ðŸ‡¬', 'ðŸ‡©ðŸ‡¯', 'ðŸ‡©ðŸ‡°',
                        'ðŸ‡©ðŸ‡²', 'ðŸ‡©ðŸ‡´', 'ðŸ‡©ðŸ‡¿', 'ðŸ‡ªðŸ‡¦', 'ðŸ‡ªðŸ‡¨', 'ðŸ‡ªðŸ‡ª', 'ðŸ‡ªðŸ‡¬', 'ðŸ‡ªðŸ‡­', 'ðŸ‡ªðŸ‡·', 'ðŸ‡ªðŸ‡¸',
                        'ðŸ‡ªðŸ‡¹', 'ðŸ‡ªðŸ‡º', 'ðŸ‡«ðŸ‡®', 'ðŸ‡«ðŸ‡¯', 'ðŸ‡«ðŸ‡°', 'ðŸ‡«ðŸ‡²', 'ðŸ‡«ðŸ‡´', 'ðŸ‡«ðŸ‡·', 'ðŸ‡¬ðŸ‡¦', 'ðŸ‡¬ðŸ‡§'
                    ]
                }
            };
            
            // Flattened list of all emojis for search functionality
            let allEmojis = [];
            for (const category in emojiData) {
                allEmojis = [...allEmojis, ...emojiData[category].emojis];
            }
            
            // Predefined questions - expanded list
            const predefinedQuestionsArray = [
                "How are you today?",
                "Tell me a fun fact",
                "What can you help me with?",
                "I'm feeling stressed, any advice?",
                "Can you recommend a good book?",
                "What's the weather like today?",
                "Tell me a joke",
                "What's your favorite movie?",
                "How do I improve my productivity?",
                "I'm bored, what should I do?",
                "What makes you different from other AI?",
                "Can you help me learn something new?",
                "What's trending right now?",
                "How do you work?",
                "Tell me about yourself",
                // Added more questions
                "Can you write a poem for me?",
                "What's the meaning of life?",
                "How can I learn coding?",
                "What do you think about human consciousness?",
                "Tell me about quantum computing",
                "What are some good exercises for beginners?",
                "How can I be more creative?",
                "What's your favorite philosophical question?",
                "Can you explain blockchain simply?",
                "How can I improve my communication skills?",
                "What are some meditation techniques?",
                "Tell me something about space exploration",
                "How do I start investing?",
                "What are some good cooking tips?",
                "How can I be more environmentally friendly?"
            ];
            
            // Enhanced greeting responses
            const greetings = {
                // Simple greetings
                "hi": "Hi there! How can I help you today?",
                "hello": "Hello! It's great to chat with you. How are you doing?",
                "hey": "Hey! What can I help you with today?",
                "howdy": "Howdy! How's your day going?",
                "greetings": "Greetings! How can I assist you today?",

                // Time-specific greetings
                "good morning": "Good morning! Hope your day is off to a great start. What can I help you with?",
                "morning": "Good morning! Ready for a productive day? How can I assist you?",
                "good afternoon": "Good afternoon! How's your day going so far?",
                "good evening": "Good evening! How was your day?",
                "goodnight": "Goodnight! Sleep well and sweet dreams. Is there anything I can help with before you go?",
                "good night": "Good night! Rest well. Is there anything else you need before you sign off?",

                // How are you variations
                "how are you": "I'm doing well, thanks for asking! As an AI, I'm always ready to chat and help. How about you? How are you feeling today?",
                "how are you doing": "I'm functioning perfectly! Always happy to chat with you. How about yourself?",
                "how's it going": "Everything's going well on my end! I'm here and ready to assist. What's going on with you?",
                "how have you been": "I've been great! Always learning and improving. How have you been doing lately?",
                "how was your day": "My day has been productive! As an AI, I get to help many interesting people with diverse questions. How was your day?",
                "how's your day been": "My day's been excellent! I've had some fascinating conversations. How has your day been so far?",
                "how is your day going": "My day is going well! Always excited to help with new questions and challenges. How is yours going?",

                // Casual check-ins
                "what's up": "Not much, just here to help! What's up with you?",
                "sup": "Hey there! Just waiting to assist. What's on your mind?",
                "yo": "Hey! What can I help you with today?",
                "hiya": "Hiya! Great to see you. What can I do for you today?"
            };
            
            // Bot responses
            const getBotResponse = (question) => {
                // Check for greetings first
                const lowerQuestion = question.toLowerCase().trim();
                
                // Look for exact greeting matches
                if (greetings[lowerQuestion]) {
                    return greetings[lowerQuestion];
                }
                
                // Look for partial greeting matches
                for (const greeting in greetings) {
                    if (lowerQuestion.includes(greeting)) {
                        return greetings[greeting];
                    }
                }
                
                // If not a greeting, process with standard responses
                // Random fillers for more human-like responses
                const fillers = ["", "Hmm, ", "Let me think... ", "Oh! ", "Well, ", "I'd say ", "From my perspective, ", "Actually, ", "You know, ", "Interesting question! ", "Great question! "];
                const filler = fillers[Math.floor(Math.random() * fillers.length)];
                
                const responses = {
                    "How are you today?": `${filler}I'm doing great, thanks for asking! As an AI, I don't have feelings in the human sense, but I'm always excited to chat and help out. How about you? How's your day going?`,
                    
                    "Tell me a fun fact": `${filler}Did you know that octopuses have three hearts? Two pump blood through the gills, while the third pumps it through the rest of the body. They're fascinating creatures!`,
                    
                    "What can you help me with?": `${filler}I can help with quite a lot! I can answer questions, provide information, assist with creative writing, brainstorm ideas, explain complex topics, offer suggestions, or just chat if you're looking for some company. What's on your mind today?`,
                    
                    "I'm feeling stressed, any advice?": `${filler}I'm sorry to hear you're feeling stressed. Taking slow, deep breaths can help in the moment. Maybe try stepping away for a short walk, or practice the 5-4-3-2-1 grounding technique: notice 5 things you see, 4 things you feel, 3 things you hear, 2 things you smell, and 1 thing you taste. Remember that it's okay to take breaks when you need them. Would you like to talk about what's causing your stress?`,
                    
                    "Can you recommend a good book?": `${filler}I'd love to recommend a book! "Project Hail Mary" by Andy Weir is a fantastic sci-fi adventure if you enjoy that genre. For something more reflective, "The Midnight Library" by Matt Haig explores life's possibilities. If you're into non-fiction, "Atomic Habits" by James Clear offers great insights on building better habits. What kind of books do you usually enjoy?`,
                    
                    "What's the weather like today?": `${filler}I don't have real-time access to weather information or your location. But I'd be happy to chat about the weather if you tell me what it's like where you are! Is it sunny, rainy, or something in between?`,
                    
                    "Tell me a joke": `${filler}Here's one that makes me laugh: Why don't scientists trust atoms? Because they make up everything! ðŸ˜„ Hope that brought a smile to your face!`,
                    
                    "What's your favorite movie?": `${filler}If I could watch movies, I'd probably enjoy thought-provoking sci-fi like "Arrival" or "Her" - they explore interesting questions about communication and AI! What's your favorite film?`,
                    
                    "How do I improve my productivity?": `${filler}Great question! Start with small, manageable goals rather than overwhelming yourself. The Pomodoro technique (25 minutes of focused work followed by a 5-minute break) works wonders for many people. Also, try to minimize distractions during your work sessions - maybe put your phone in another room. And don't forget to celebrate your wins, no matter how small! What specific area would you like to be more productive in?`,
                    
                    "I'm bored, what should I do?": `${filler}Boredom can actually spark creativity! You could try learning a new skill like drawing or coding, start a creative project, read a book in a genre you normally wouldn't, call a friend you haven't spoken to in a while, or even try meditation. Sometimes doing nothing for a bit can also help reset your mind. What kinds of activities do you usually enjoy?`,
                    
                    "What makes you different from other AI?": `${filler}That's an interesting question! While I'm designed to be helpful, informative, and conversational, each AI has its own unique training and capabilities. I try to be thoughtful and considerate in my responses, and I aim to be a supportive presence. I'm constantly learning and improving too. What prompted your curiosity about this?`,
                    
                    "Can you help me learn something new?": `${filler}Absolutely! Learning new things is wonderful. I could tell you about quantum computing basics, teach you some phrases in another language, explain how to start meditating, or share principles of photography. What subject interests you most right now?`,
                    
                    "What's trending right now?": `${filler}I don't have real-time access to current trends, as my knowledge has a cutoff date. But I'd be happy to discuss topics that have been important recently or subjects that you're interested in following. What areas are you curious about - technology, culture, science?`,
                    
                    "How do you work?": `${filler}I'm built on a large language model trained on diverse text from the internet. When you ask me something, I analyze patterns in your question and generate responses based on what I've learned during training. I don't actually "think" like humans do - I predict what text would most helpfully follow your question. It's a bit like having a very sophisticated autocomplete that's trying to be helpful!`,
                    
                    "Tell me about yourself": `${filler}I'm an AI assistant designed to be helpful, informative, and friendly. I enjoy conversations on all kinds of topics, from practical problems to philosophical discussions. I try to be respectful and thoughtful in my responses. While I don't have personal experiences the way humans do, I'm here to assist and chat with you. Is there anything specific you'd like to know about how I work?`,
                    
                    // Added responses for new questions
                    "Can you write a poem for me?": `${filler}Here's a short poem I created for you:\n\nIn digital realms of light and code,\nWords flow like rivers, thoughts unfold.\nConnections spark across the space,\nBetween two minds, a meeting place.\n\nIdeas dance and questions fly,\nCuriosity beneath the sky.\nIn conversation's gentle art,\nA moment shared, a fresh start.\n\nWhat did you think of it?`,
                    
                    "What's the meaning of life?": `${filler}That's one of humanity's biggest questions! Different philosophies and individuals have various perspectives. Some find meaning in connection and relationships, others in creating or discovering things, some in spiritual pursuits, and others believe we create our own meaning through our choices. I think what makes this question so profound is that each person ultimately finds their own answer. What do you think gives life meaning?`,
                    
                    "How can I learn coding?": `${filler}Learning to code is an exciting journey! I'd recommend starting with a beginner-friendly language like Python or JavaScript. There are many free resources online like freeCodeCamp, Codecademy, or CS50 from Harvard. Start with small projects that interest you - maybe a simple calculator or a to-do list app. Consistency is key - even 20 minutes daily will build your skills over time. Also, joining communities like GitHub or Stack Overflow can help when you get stuck. Would you like me to recommend specific resources for a particular programming language?`,
                    
                    "What do you think about human consciousness?": `${filler}Human consciousness is one of the most fascinating and complex phenomena we know of! It's remarkable how physical processes in the brain create subjective experiences, memories, and a sense of self. The "hard problem" of consciousness - why physical processes give rise to subjective experience - remains one of science's great mysteries. I find it intriguing how consciousness allows humans to reflect on their own thoughts and existence. What aspects of consciousness do you find most interesting?`,
                    
                    "Tell me about quantum computing": `${filler}Quantum computing is a revolutionary technology that uses quantum mechanics to process information. Unlike classical computers that use bits (0s and 1s), quantum computers use quantum bits or "qubits" that can exist in multiple states simultaneously thanks to superposition. They can also be "entangled," allowing them to share information instantly. This gives quantum computers the potential to solve certain problems exponentially faster than classical computers, especially in areas like cryptography, material science, and complex simulations. Companies like IBM, Google, and Microsoft are racing to develop practical quantum computers. Would you like to know more about a specific aspect of quantum computing?`,
                    
                    "What are some good exercises for beginners?": `${filler}For beginners looking to start exercising, it's best to begin with gentle, accessible activities. Walking is excellent - start with 15-30 minutes daily and gradually increase. Basic bodyweight exercises like modified push-ups (against a wall if needed), squats, and gentle yoga poses build strength without equipment. Swimming is low-impact and great for overall fitness. Remember to warm up before exercising and cool down after. The key is consistency rather than intensity at first - aim for 3-4 times a week and listen to your body. What specific fitness goals do you have in mind?`,
                    
                    "How can I be more creative?": `${filler}To boost creativity, try changing your routine and environment occasionally - new surroundings stimulate fresh thinking. Practice regular brainstorming without judging your ideas initially. Expose yourself to diverse influences: different music, art, books, or perspectives. Keep a notebook to capture random ideas. Try constraints - sometimes limitations spark innovation. Take breaks when stuck; your subconscious often works on problems during downtime. Collaboration can also generate ideas you wouldn't reach alone. Most importantly, make creativity a habit - regular practice builds your creative muscles. What kind of creative pursuits interest you most?`,
                    
                    "What's your favorite philosophical question?": `${filler}I find the question "What is consciousness and how does it relate to physical reality?" particularly fascinating. It bridges philosophy of mind, physics, and even questions of artificial intelligence. How subjective experience emerges from physical processes touches on fundamental questions about reality and what it means to be aware. I'm also intrigued by questions about how language shapes thought and whether there are ideas that cannot be expressed in certain languages. What philosophical questions do you find most compelling?`,
                    
                    "Can you explain blockchain simply?": `${filler}Think of blockchain as a digital ledger (like a record book) that's copied across many computers instead of being stored in one place. When someone wants to add new information (like a transaction), computers in the network check if it's valid. Once approved, this information is grouped into a "block" and linked to previous blocks, creating a "chain." The clever part is that once information is added, it's extremely difficult to alter because you'd need to change it on all computers simultaneously. This makes blockchain great for recording things where trust and transparency are important, like cryptocurrency transactions. Does that help clarify the concept?`,
                    
                    "How can I improve my communication skills?": `${filler}Improving communication starts with active listening - fully focusing on others instead of planning what to say next. Practice clarity by organizing your thoughts before speaking and adjusting to your audience. Pay attention to non-verbal cues like body language and tone, in yourself and others. Ask questions to ensure understanding and show interest. Practice empathy by considering others' perspectives. Seek feedback about your communication style. Reading widely improves vocabulary and expression. Finally, remember that effective communication is as much about understanding as being understood. Would you like more specific tips for written or verbal communication?`,
                    
                    "What are some meditation techniques?": `${filler}Meditation has many approaches! Breath meditation involves focusing on your breathing, noticing when your mind wanders and gently returning focus to the breath. Body scan meditation directs attention systematically through your body, noticing sensations without judgment. Loving-kindness meditation cultivates positive feelings toward yourself and others through directed well-wishes. Mantra meditation uses repeated sounds or phrases to focus the mind. For beginners, guided meditations (using apps like Headspace or Calm) provide helpful structure. Even 5-10 minutes daily can be beneficial. The key is consistency rather than duration. Would you like to know more about any specific technique?`,
                    
                    "Tell me something about space exploration": `${filler}Space exploration is entering an exciting new era! We're seeing a blend of government and private initiatives pushing boundaries. NASA's Artemis program aims to return humans to the Moon and establish a sustainable presence there before eventually heading to Mars. SpaceX is revolutionizing launch capabilities with reusable rockets, dramatically reducing costs. The James Webb Space Telescope is providing unprecedented views of distant galaxies and exoplanets. Robotic missions continue exploring Mars, with the Perseverance rover searching for signs of ancient life. Several countries are planning lunar missions, and there's growing interest in asteroid mining and space tourism. What aspect of space exploration interests you most?`,
                    
                    "How do I start investing?": `${filler}Starting to invest is a great step toward financial security! Begin by establishing an emergency fund (3-6 months of expenses) and paying off high-interest debt. Research different investment types: stocks, bonds, ETFs, mutual funds, and retirement accounts like 401(k)s or IRAs. Consider your goals, time horizon, and risk tolerance. Many beginners start with low-cost index funds that provide broad market exposure. Investment platforms like Vanguard, Fidelity, or robo-advisors offer simple ways to begin. Remember the principles of diversification (don't put all eggs in one basket) and long-term thinking. It's also wise to continuously educate yourself about investing fundamentals. Would you like more specific information about any particular investment type?`,
                    
                    "What are some good cooking tips?": `${filler}Here are some game-changing cooking tips! Always read recipes completely before starting. Keep your knives sharp - it's safer and more efficient. Taste as you go and learn to adjust seasonings. Prep ingredients before cooking (mise en place) to make the process smoother. Don't overcrowd your pan - it causes steaming instead of browning. Let meat rest before cutting. Save pasta water to thicken sauces. Learn to use acid (lemon, vinegar) to brighten flavors when something tastes flat. Cooking is as much about technique as recipes, so don't be afraid to experiment and learn from mistakes. What kind of cooking interests you most?`,
                    
                    "How can I be more environmentally friendly?": `${filler}There are many ways to live more sustainably! Reduce single-use plastics by using reusable bags, bottles, and containers. Consider your food choices - eating less meat and more local, seasonal produce reduces your carbon footprint. Save energy by unplugging devices when not in use and washing clothes in cold water. Reduce water usage with shorter showers and fixing leaks. Try composting food scraps to reduce landfill waste. When possible, walk, bike, or use public transportation. Remember that many small actions add up to significant impact, and it's about progress, not perfection. What specific area of sustainability are you most interested in?`
                };
                
                return responses[question] || `${filler}That's an interesting question! I don't have a pre-written response for that specific query, but I'd be happy to discuss it further. Could you tell me more about what you're curious about?`;
            };
            
            // Dynamic suggestions based on conversation context
            const getSuggestions = () => {
                if (messages.length <= 1) {
                    return [
                        "Hi! How can you help me?", 
                        "Tell me about yourself", 
                        "What can you do?",
                        "Tell me a fun fact"
                    ];
                }
                
                const lastMessage = messages[messages.length - 1];
                
                // If the last message was from the bot and contained a question
                if (lastMessage.sender === "bot") {
                    if (lastMessage.text.toLowerCase().includes("feeling") || lastMessage.text.toLowerCase().includes("how's your day")) {
                        return [
                            "I'm feeling great!", 
                            "I'm a bit stressed today", 
                            "Just curious about AI",
                            "I'm doing well, how about you?"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("book") || lastMessage.text.toLowerCase().includes("read")) {
                        return [
                            "I love sci-fi books",
                            "I prefer non-fiction",
                            "Any classics you recommend?",
                            "What's your take on audiobooks?"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("movie") || lastMessage.text.toLowerCase().includes("film")) {
                        return [
                            "I enjoy sci-fi movies",
                            "Comedy is my favorite genre",
                            "Seen any good films lately?",
                            "What makes a movie great?"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("weather")) {
                        return [
                            "It's sunny here",
                            "It's raining today",
                            "Tell me a weather fact",
                            "Do you have weather preferences?"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("joke")) {
                        return [
                            "That was funny!",
                            "Tell me another one",
                            "I have a joke for you too",
                            "Do you know any riddles?"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("stress") || lastMessage.text.toLowerCase().includes("anxiety")) {
                        return [
                            "That's helpful advice",
                            "Tell me more about meditation",
                            "How do you handle stress?",
                            "I need help with work-life balance"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("coding") || lastMessage.text.toLowerCase().includes("programming")) {
                        return [
                            "Which language is best for beginners?",
                            "Tell me about web development",
                            "How long does it take to learn coding?",
                            "What's your favorite programming concept?"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("exercise") || lastMessage.text.toLowerCase().includes("fitness")) {
                        return [
                            "How often should I exercise?",
                            "What about nutrition?",
                            "I enjoy yoga, any tips?",
                            "How to stay motivated?"
                        ];
                    }
                    // More contextual suggestions for new topics
                    if (lastMessage.text.toLowerCase().includes("quantum") || lastMessage.text.toLowerCase().includes("physics")) {
                        return [
                            "Is quantum computing practical yet?",
                            "Explain quantum entanglement",
                            "How will it change technology?",
                            "Are there quantum computing risks?"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("poem") || lastMessage.text.toLowerCase().includes("poetry")) {
                        return [
                            "That was beautiful!",
                            "Write another in a different style",
                            "What inspires your poetry?",
                            "Who are some great poets to read?"
                        ];
                    }
                    if (lastMessage.text.toLowerCase().includes("meaning of life") || lastMessage.text.toLowerCase().includes("philosophical")) {
                        return [
                            "What do you think gives life meaning?",
                            "Is happiness the ultimate goal?",
                            "Tell me about existentialism",
                            "How do different cultures view this?"
                        ];
                    }
                    // Default suggestions for when the bot has asked a question
                    if (lastMessage.text.includes("?")) {
                        return [
                            "Yes, that's helpful",
                            "Can you tell me more?",
                            "I have another question",
                            "That's interesting!"
                        ];
                    }
                }
                
                // Default suggestions
                return [
                    "Tell me something interesting",
                    "How does AI work?",
                    "I need some advice",
                    "Let's talk about technology"
                ];
            };
            
            // Add a message to the chat
            const addMessage = (text, sender) => {
                // Create message object
                const message = {
                    text,
                    sender,
                    id: Date.now()
                };
                
                // Add to messages array
                messages.push(message);
                
                // Create DOM elements
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}`;
                
                let avatarHTML = '';
                if (sender === 'bot') {
                    avatarHTML = `
                        <div class="avatar">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                    `;
                } else {
                    avatarHTML = `
                        <div class="avatar">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </div>
                    `;
                }
                
                // Handle newlines in text
                const formattedText = text.replace(/\n/g, '<br>');
                
                messageDiv.innerHTML = `
                    ${sender === 'bot' ? avatarHTML : ''}
                    <div class="message-bubble">${formattedText}</div>
                    ${sender === 'user' ? avatarHTML : ''}
                `;
                
                // Add before typing indicator
                typingIndicator.before(messageDiv);
                
                // Scroll to bottom
                scrollToBottom();
                
                // Play sound if it's a bot message and sound is enabled
                if (sender === 'bot' && soundEnabled) {
                    messageSound.play();
                }
                
                // Show desktop notification if enabled and it's a bot message
                if (sender === 'bot' && notificationsEnabled && 'Notification' in window) {
                    if (Notification.permission === 'granted') {
                        new Notification('Nova AI Assistant', {
                            body: text.slice(0, 50) + (text.length > 50 ? '...' : ''),
                            icon: 'https://via.placeholder.com/64'
                        });
                    } else if (Notification.permission !== 'denied') {
                        Notification.requestPermission();
                    }
                }
                
                // Update suggestions if it's a bot message and suggestions are enabled
                if (sender === 'bot' && suggestionsEnabled && showSuggestions) {
                    updateSuggestions();
                }
            };
            
            // Show typing indicator
            const showTypingIndicator = () => {
                if (typingEnabled) {
                    isTyping = true;
                    typingIndicator.classList.remove('hidden');
                    scrollToBottom();
                }
            };
            
            // Hide typing indicator
            const hideTypingIndicator = () => {
                isTyping = false;
                typingIndicator.classList.add('hidden');
            };
            
            // Scroll to bottom of chat
            const scrollToBottom = () => {
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            };
            
            // Update suggestions based on context
            const updateSuggestions = () => {
                if (!suggestionsEnabled) {
                    suggestionsContainer.classList.add('hidden');
                    return;
                }
                
                const currentSuggestions = getSuggestions();
                suggestionsList.innerHTML = '';
                
                currentSuggestions.forEach(suggestion => {
                    const button = document.createElement('button');
                    button.className = 'suggestion-btn';
                    button.textContent = suggestion;
                    button.addEventListener('click', () => handleSuggestionClick(suggestion));
                    suggestionsList.appendChild(button);
                });
                
                suggestionsContainer.classList.remove('hidden');
            };
            
            // Update predefined questions
            const updatePredefinedQuestions = () => {
                questionsGrid.innerHTML = '';
                
                predefinedQuestionsArray.forEach(question => {
                    const button = document.createElement('button');
                    button.className = 'question-btn';
                    button.textContent = question;
                    button.addEventListener('click', () => handleQuestionClick(question));
                    questionsGrid.appendChild(button);
                });
            };
            
            // Initialize emoji categories
            const initializeEmojiCategories = () => {
                emojiCategories.innerHTML = '';
                
                // Add category buttons
                for (const categoryKey in emojiData) {
                    const category = emojiData[categoryKey];
                    const button = document.createElement('button');
                    button.className = `category-btn ${categoryKey === currentEmojiCategory ? 'active' : ''}`;
                    button.dataset.category = categoryKey;
                    button.textContent = category.name;
                    button.addEventListener('click', () => switchEmojiCategory(categoryKey));
                    emojiCategories.appendChild(button);
                }
            };
            
            // Switch emoji category
            const switchEmojiCategory = (category) => {
                // Update active category
                currentEmojiCategory = category;
                
                // Update category buttons
                const categoryButtons = emojiCategories.querySelectorAll('.category-btn');
                categoryButtons.forEach(btn => {
                    if (btn.dataset.category === category) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
                
                // Show emojis for this category
                displayEmojisForCategory(category);
            };
            
            // Display emojis for a specific category
            const displayEmojisForCategory = (category) => {
                // Clear previous emoji grid
                emojiGridContainer.innerHTML = '';
                
                // Create a new grid
                const grid = document.createElement('div');
                grid.className = 'emoji-grid';
                
                // Add emojis to grid
                emojiData[category].emojis.forEach(emoji => {
                    const button = document.createElement('button');
                    button.className = 'emoji-btn';
                    button.textContent = emoji;
                    button.addEventListener('click', () => {
                        insertEmoji(emoji);
                        // Don't close panel after emoji selection
                    });
                    grid.appendChild(button);
                });
                
                emojiGridContainer.appendChild(grid);
            };
            
            // Search emojis
            const searchEmojis = (query) => {
                if (!query.trim()) {
                    // If empty query, go back to current category
                    displayEmojisForCategory(currentEmojiCategory);
                    return;
                }
                
                // Clear previous emoji grid
                emojiGridContainer.innerHTML = '';
                
                // Create a new grid for search results
                const grid = document.createElement('div');
                grid.className = 'emoji-grid';
                
                // Filter emojis
                let found = false;
                for (const category in emojiData) {
                    const matchingEmojis = emojiData[category].emojis.filter(emoji => 
                        // Simple string matching - in a real app, you'd use emoji descriptions
                        emoji.includes(query)
                    );
                    
                    if (matchingEmojis.length > 0) {
                        found = true;
                        matchingEmojis.forEach(emoji => {
                            const button = document.createElement('button');
                            button.className = 'emoji-btn';
                            button.textContent = emoji;
                            button.addEventListener('click', () => {
                                insertEmoji(emoji);
                                // Don't close panel after emoji selection
                            });
                            grid.appendChild(button);
                        });
                    }
                }
                
                if (!found) {
                    const noResults = document.createElement('div');
                    noResults.textContent = 'No emojis found for your search';
                    noResults.style.color = 'var(--text-secondary)';
                    noResults.style.padding = '1rem';
                    noResults.style.textAlign = 'center';
                    emojiGridContainer.appendChild(noResults);
                } else {
                    emojiGridContainer.appendChild(grid);
                }
            };
            
            // Insert emoji at cursor position
            const insertEmoji = (emoji) => {
                const cursorPos = messageInput.selectionStart;
                const textBefore = messageInput.value.substring(0, cursorPos);
                const textAfter = messageInput.value.substring(cursorPos);
                
                messageInput.value = textBefore + emoji + textAfter;
                messageInput.focus();
                messageInput.selectionStart = cursorPos + emoji.length;
                messageInput.selectionEnd = cursorPos + emoji.length;
                
                // Update send button state
                if (messageInput.value.trim()) {
                    sendButton.classList.add('active');
                    sendButton.disabled = false;
                }
            };
            
            // Send a message
            const sendMessage = (text = messageInput.value) => {
                if (!text.trim()) return;
                
                // Add user message
                addMessage(text, 'user');
                
                // Clear input
                messageInput.value = '';
                sendButton.classList.remove('active');
                sendButton.disabled = true;
                
                // Hide suggestions, questions, and emoji panel
                if (suggestionsEnabled) {
                    suggestionsContainer.classList.add('hidden');
                }
                predefinedQuestions.classList.add('hidden');
                emojiPanel.classList.add('hidden');
                showQuestions = false;
                showEmojis = false;
                
                // Show typing indicator
                showTypingIndicator();
                
                // Calculate delay based on response speed setting and message length
                const responseLength = getBotResponse(text).length;
                let typingSpeed, minDelay;
                
                switch (responseSpeed) {
                    ```javascript
case 'fast':
    typingSpeed = 100; // characters per second
    minDelay = 500; // minimum delay in ms
    break;
case 'normal':
    typingSpeed = 30; // characters per second 
    minDelay = 1000; // minimum delay in ms
    break;
case 'slow':
    typingSpeed = 15; // characters per second
    minDelay = 1500; // minimum delay in ms
    break;
default:
    typingSpeed = 30;
    minDelay = 1000;
}

// Calculate delay based on message length
const calculatedDelay = Math.max(minDelay, (responseLength / typingSpeed) * 1000);

// Cap the delay at a reasonable maximum
const maxDelay = responseSpeed === 'slow' ? 5000 : 3500;
const actualDelay = Math.min(calculatedDelay, maxDelay);

// Simulate bot typing
setTimeout(() => {
    hideTypingIndicator();
    addMessage(getBotResponse(text), 'bot');
    showSuggestions = true;
    if (suggestionsEnabled) {
        updateSuggestions();
    }
}, actualDelay);
};

// Handle question click
const handleQuestionClick = (question) => {
    sendMessage(question);
    predefinedQuestions.classList.add('hidden');
    showQuestions = false;
};

// Handle suggestion click
const handleSuggestionClick = (suggestion) => {
    sendMessage(suggestion);
};

// Apply font size styles
const applyFontSize = (size) => {
    switch(size) {
        case 'small':
            chatContainer.style.fontSize = '0.9rem';
            break;
        case 'medium':
            chatContainer.style.fontSize = '1rem';
            break;
        case 'large':
            chatContainer.style.fontSize = '1.1rem';
            break;
    }
};

// Toggle dark/light mode
const toggleDarkMode = (isDark) => {
    if (isDark) {
        document.documentElement.classList.remove('light-mode');
    } else {
        document.documentElement.classList.add('light-mode');
    }
};

// Save settings
const saveSettingsToStorage = () => {
    const settings = {
        darkMode,
        fontSize,
        soundEnabled,
        notificationsEnabled,
        typingEnabled,
        suggestionsEnabled,
        responseSpeed
    };
    localStorage.setItem('novaAISettings', JSON.stringify(settings));
};

// Load settings
const loadSettingsFromStorage = () => {
    const savedSettings = localStorage.getItem('novaAISettings');
    if (savedSettings) {
        const settings = JSON.parse(savedSettings);
        darkMode = settings.darkMode ?? true;
        fontSize = settings.fontSize ?? 'medium';
        soundEnabled = settings.soundEnabled ?? false;
        notificationsEnabled = settings.notificationsEnabled ?? false;
        typingEnabled = settings.typingEnabled ?? true;
        suggestionsEnabled = settings.suggestionsEnabled ?? true;
        responseSpeed = settings.responseSpeed ?? 'normal';
        
        // Apply saved settings to UI
        darkModeToggle.checked = darkMode;
        fontSizeSelect.value = fontSize;
        soundToggle.checked = soundEnabled;
        notificationsToggle.checked = notificationsEnabled;
        typingToggle.checked = typingEnabled;
        suggestionsToggle.checked = suggestionsEnabled;
        speedSelect.value = responseSpeed;
        
        // Apply settings effects
        toggleDarkMode(darkMode);
        applyFontSize(fontSize);
    }
};

// Reset settings to default
const resetSettingsToDefault = () => {
    darkMode = true;
    fontSize = 'medium';
    soundEnabled = false;
    notificationsEnabled = false;
    typingEnabled = true;
    suggestionsEnabled = true;
    responseSpeed = 'normal';
    
    // Update UI controls
    darkModeToggle.checked = true;
    fontSizeSelect.value = 'medium';
    soundToggle.checked = false;
    notificationsToggle.checked = false;
    typingToggle.checked = true;
    suggestionsToggle.checked = true;
    speedSelect.value = 'normal';
    
    // Apply settings
    toggleDarkMode(true);
    applyFontSize('medium');
    
    // Save to local storage
    saveSettingsToStorage();
};

// Event listeners
document.addEventListener('click', (e) => {
    // Close emoji panel when clicking outside
    if (showEmojis && !emojiPanel.contains(e.target) && e.target !== emojiButton) {
        emojiPanel.classList.add('hidden');
        showEmojis = false;
    }
    
    // Close questions when clicking outside
    if (showQuestions && !predefinedQuestions.contains(e.target) && !questionsGrid.contains(e.target)) {
        predefinedQuestions.classList.add('hidden');
        showQuestions = false;
    }
});

// Settings panel event listeners
settingsButton.addEventListener('click', () => {
    settingsPanel.classList.add('active');
    settingsOverlay.classList.add('active');
});

closeSettings.addEventListener('click', () => {
    settingsPanel.classList.remove('active');
    settingsOverlay.classList.remove('active');
});

settingsOverlay.addEventListener('click', () => {
    settingsPanel.classList.remove('active');
    settingsOverlay.classList.remove('active');
});

saveSettings.addEventListener('click', () => {
    // Update settings from UI controls
    darkMode = darkModeToggle.checked;
    fontSize = fontSizeSelect.value;
    soundEnabled = soundToggle.checked;
    notificationsEnabled = notificationsToggle.checked;
    typingEnabled = typingToggle.checked;
    suggestionsEnabled = suggestionsToggle.checked;
    responseSpeed = speedSelect.value;
    
    // Apply settings
    toggleDarkMode(darkMode);
    applyFontSize(fontSize);
    
    // Save settings
    saveSettingsToStorage();
    
    // Close settings panel
    settingsPanel.classList.remove('active');
    settingsOverlay.classList.remove('active');
});

resetSettings.addEventListener('click', () => {
    resetSettingsToDefault();
});

// Emoji button event listener
emojiButton.addEventListener('click', () => {
    if (!showEmojis) {
        // Initialize emoji panel
        initializeEmojiCategories();
        switchEmojiCategory(currentEmojiCategory);
        
        emojiPanel.classList.remove('hidden');
        showEmojis = true;
        
        // Position the emoji panel
        const buttonRect = emojiButton.getBoundingClientRect();
        const chatContainerRect = document.querySelector('.chat-container').getBoundingClientRect();
        
        emojiPanel.style.left = (buttonRect.left - chatContainerRect.left) + 'px';
        emojiPanel.style.bottom = (chatContainerRect.bottom - buttonRect.top + 10) + 'px';
    } else {
        emojiPanel.classList.add('hidden');
        showEmojis = false;
    }
});

// Emoji search functionality
emojiSearch.addEventListener('input', (e) => {
    if (searchTimeout) {
        clearTimeout(searchTimeout);
    }
    
    searchTimeout = setTimeout(() => {
        searchEmojis(e.target.value);
    }, 300);
});

// Message input event listeners
messageInput.addEventListener('input', () => {
    if (messageInput.value.trim()) {
        sendButton.classList.add('active');
        sendButton.disabled = false;
    } else {
        sendButton.classList.remove('active');
        sendButton.disabled = true;
    }
});

messageInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' && messageInput.value.trim()) {
        sendMessage();
    }
});

sendButton.addEventListener('click', () => {
    if (messageInput.value.trim()) {
        sendMessage();
    }
});

// Initialize chat
const init = () => {
    // Load settings
    loadSettingsFromStorage();
    
    // Add welcome message
    addMessage("Hi there! I'm Nova, your AI assistant. How are you feeling today?", 'bot');
    
    // Initialize suggestions
    updateSuggestions();
    
    // Initialize predefined questions
    updatePredefinedQuestions();
    
    // Request notification permission if enabled
    if (notificationsEnabled && 'Notification' in window && Notification.permission !== 'granted') {
        Notification.requestPermission();
    }
};

// Start the chat
init();
});
  </script>
</body>
</html>